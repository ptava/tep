. ${WM_PROJECT_DIR:?}/bin/tools/RunFunctions 

# Create background grid based on "userDict" parameters
runApplication blockMesh

# Decompose domain for parallel processing
runApplication -s cast snappyHexMesh \
    -dict system/snappyHexMeshDict.cast \
    -overwrite

# echo "Running snappyHexMesh (snap) in parallel..."
# runParallel -s snap snappyHexMesh \
#     -dict system/snappyHexMeshDict.snap \
#     -overwrite

echo "Checking mesh after snappyHexMesh (snap)..."
runApplication checkMesh -constant

echo "Running topoSet..."
runApplication topoSet -dict system/topoSetDict

echo "Renumbering mesh..."
runApplication -s decompose decomposePar -constant -force
runParallel renumberMesh -constant -overwrite

echo "Initializing solution..."
runParallel potentialFoam

echo "Running simpleFoam..."
runParallel simpleFoam 
